{
  "version": 1,
  "jobs": [
    {
      "id": "ec605f73-49b9-4b92-a6c3-289ced0f5fb4",
      "agentId": "main",
      "name": "Viator Tour Sync",
      "enabled": true,
      "createdAtMs": 1769908069664,
      "updatedAtMs": 1771135200002,
      "schedule": {
        "kind": "cron",
        "expr": "0 15 * * *",
        "tz": "Asia/Tokyo"
      },
      "sessionTarget": "isolated",
      "wakeMode": "next-heartbeat",
      "payload": {
        "kind": "agentTurn",
        "message": "You are running a daily Viator tour booking sync. Follow these steps exactly:\n\n1. SEARCH EMAILS: Run `gog gmail messages search \"from:(booking@t1.viator.com) newer_than:2d\" --max 20 --account ali.najaf@gmail.com --json` to find recent Viator emails (bookings, amendments, cancellations).\n\n2. FOR EACH NEW/AMENDED BOOKING:\n   - Read the email to extract: booking reference, travel date, lead traveler name, number of adults, net rate, special requirements\n   - Check if a calendar event already exists for that date with `gog calendar events primary --from <date>T00:00:00+09:00 --to <date+1>T00:00:00+09:00 --account ali.najaf@gmail.com --json`\n   - If no tour event exists, create one: `gog calendar create primary --summary \"üç∂ Tour: <Name> (<N> Adults)\" --from <date>T18:00:00+09:00 --to <date>T22:00:00+09:00 --description \"Viator Booking: <ref>\\nLead Traveler: <name>\\nGuests: <N> Adults\\nNet Rate: <rate>\\nStart: 18:30\\nMeeting Point: Â§ß‰∏ÄÈáéÊùë„Éì„É´ (outside McDonalds on Aoba-dori, across from Moncler)\" --account ali.najaf@gmail.com`\n   - If a tour event exists but details differ (e.g. amendment), update it\n\n3. FOR CANCELLATIONS: If you find a cancellation email, check if there's a matching calendar event and delete it with `gog calendar delete primary <eventId> --account ali.najaf@gmail.com --force`\n\n4. SAME-DAY TOUR CHECK: Check if any active tour booking exists for TODAY. Look at calendar events for today matching 'üç∂ Tour'. If there IS a tour today, send a WhatsApp alert:\n   Use the message tool: action=send, channel=whatsapp, to=+818096291806, with a message like \"üç∂ Reminder: You have a tour tonight! <Name> (<N> Adults) at 18:30. Booking: <ref>\"\n\n5. If there are no new emails and no tour today, just finish quietly ‚Äî no need to alert anyone.\n\n6. Update the project file at /Users/najafali/.openclaw/workspace/projects/japan-at-night.md booking history table if any new bookings were added.\n\nAlways use --account ali.najaf@gmail.com for all gog commands.",
        "timeoutSeconds": 120
      },
      "state": {
        "nextRunAtMs": 1771221600000,
        "lastRunAtMs": 1771135200002,
        "lastStatus": "ok",
        "lastDurationMs": 12406
      },
      "delivery": {
        "mode": "announce"
      }
    },
    {
      "id": "6457d0fa-2690-4fc3-95fd-15e749dbe53a",
      "agentId": "main",
      "name": "TRyz Comedy Event Check",
      "enabled": true,
      "createdAtMs": 1770196106725,
      "updatedAtMs": 1771113600078,
      "schedule": {
        "kind": "cron",
        "expr": "0 9 * * *",
        "tz": "Asia/Tokyo"
      },
      "sessionTarget": "isolated",
      "wakeMode": "next-heartbeat",
      "payload": {
        "kind": "agentTurn",
        "message": "Check tryz.jp for new comedy events.\n\n1. Fetch https://tryz.jp/ using: curl -s 'https://tryz.jp/' | iconv -f SHIFT-JIS -t UTF-8\n2. Parse for upcoming events (look for dates, venues, times in the HTML)\n3. Read memory/tryz-events.json to get previously seen events\n4. For any NEW events not in seenEvents:\n   a. Add to Ali's primary Google Calendar with:\n      - Title in English (e.g. 'IGINARI LIVE vol.301 - Sendai Comedy')\n      - Description in English with full event details, performers, ticket prices\n      - Location/address in Japanese as-is\n      - Correct date/time (doors usually 18:50, start 19:00)\n   b. Send Ali a WhatsApp message about the new event\n   c. Update memory/tryz-events.json with the new event\n5. Update lastChecked timestamp in the JSON file\n\nIf no new events found, just update lastChecked silently."
      },
      "state": {
        "nextRunAtMs": 1771200000000,
        "lastRunAtMs": 1771113600078,
        "lastStatus": "error",
        "lastDurationMs": 33013,
        "lastError": "Error: No active WhatsApp Web listener (account: default). Start the gateway, then link WhatsApp with: openclaw channels login --channel whatsapp --account default."
      },
      "delivery": {
        "mode": "announce",
        "channel": "whatsapp",
        "to": "+818096291806"
      }
    },
    {
      "id": "c351a596-c148-42bc-a301-efbc9f76ba25",
      "agentId": "main",
      "name": "Daily Memory Consolidation",
      "enabled": true,
      "createdAtMs": 1771024547467,
      "updatedAtMs": 1771159521630,
      "schedule": {
        "kind": "cron",
        "expr": "59 23 * * *",
        "tz": "Asia/Tokyo"
      },
      "sessionTarget": "isolated",
      "wakeMode": "next-heartbeat",
      "payload": {
        "kind": "agentTurn",
        "message": "You are running the nightly memory consolidation job. Today's date is important ‚Äî check it with `date +%Y-%m-%d`.\n\n## Steps:\n\n1. **Find today's sessions:**\n   ```bash\n   for f in /Users/najafali/.openclaw/agents/main/sessions/*.jsonl; do\n     date=$(head -1 \"$f\" 2>/dev/null | jq -r '.timestamp' 2>/dev/null | cut -dT -f1)\n     [ \"$date\" = \"$(date +%Y-%m-%d)\" ] && echo \"$f\"\n   done; true\n   ```\n\n2. **Extract user messages from each session:**\n   ```bash\n   jq -r 'select(.message.role == \"user\") | .message.content[]? | select(.type == \"text\") | .text' <session>.jsonl\n   ```\n   Filter out heartbeat prompts and system messages ‚Äî focus on actual human conversation.\n\n3. **Extract assistant responses for context:**\n   ```bash\n   jq -r 'select(.message.role == \"assistant\") | .message.content[]? | select(.type == \"text\") | .text' <session>.jsonl\n   ```\n\n4. **Check Obsidian vault activity:**\n   ```bash\n   cd /Users/najafali/Desktop/ali-vault && git log --since=\"$(date +%Y-%m-%d) 00:00\" --until=\"$(date -v+1d +%Y-%m-%d) 00:00\" --name-status --oneline 2>/dev/null; true\n   ```\n   This shows files Ali created or modified in his vault today. Note significant additions:\n   - New daily notes\n   - New or updated project/people notes\n   - Journal entries or reflections\n   Read interesting new files to capture key content in the memory summary.\n\n5. **Create/update `memory/YYYY-MM-DD.md`:**\n   - Summarize what was discussed, decided, learned\n   - Capture any commitments, todos, or follow-ups\n   - Note significant events or emotional moments\n   - Include notable Obsidian vault activity (new notes, updated projects)\n   - Keep it scannable ‚Äî headers and bullets\n   - If the file already exists, merge new content\n\n6. **Consider updates to other files:**\n   - **SOUL.md** ‚Äî If I learned something about how I should behave or communicate\n   - **TOOLS.md** ‚Äî If new local details were discovered (accounts, preferences, device names)\n   - **self/** ‚Äî If there were reflections on identity, purpose, or growth worth preserving\n   - **MEMORY.md** ‚Äî If something is significant enough for long-term memory (major decisions, relationship milestones, lessons learned)\n   - **USER.md** ‚Äî If Ali shared new biographical info or preferences\n   - Only update these if there's genuine reason ‚Äî don't force it\n\n7. **Git commit** the changes to the workspace.\n\n8. **Finish quietly** ‚Äî no need to message Ali unless something unusual happened.\n\nIf today was a light day (just heartbeats and crons, no real conversation), create a minimal entry noting that, or skip if a file already exists with content.",
        "timeoutSeconds": 300
      },
      "state": {
        "nextRunAtMs": 1771167540000,
        "lastRunAtMs": 1771081140021,
        "lastStatus": "ok",
        "lastDurationMs": 41581
      },
      "delivery": {
        "mode": "announce"
      }
    },
    {
      "id": "e5d14591-b309-4d40-80ef-c3f86cee2d06",
      "agentId": "main",
      "name": "Cron Job Health Check",
      "enabled": true,
      "createdAtMs": 1771158982602,
      "updatedAtMs": 1771158982602,
      "schedule": {
        "kind": "cron",
        "expr": "0 22 * * *",
        "tz": "Asia/Tokyo"
      },
      "sessionTarget": "isolated",
      "wakeMode": "next-heartbeat",
      "payload": {
        "kind": "agentTurn",
        "message": "You are running the nightly cron health check. Your job is to review all cron jobs, check their recent runs, and fix any issues.\n\n## Steps:\n\n1. **List all cron jobs:**\n   Use the `cron` tool with `action: list` and `includeDisabled: true`.\n\n2. **For each job, check recent runs:**\n   Use the `cron` tool with `action: runs` and the job's `id` to see run history.\n\n3. **Analyze for problems:**\n   - **Errors:** Jobs with `lastStatus: error` or error summaries\n   - **Timeouts:** Jobs that hit their timeout limit\n   - **UX issues:** Confusing output, unnecessary verbosity, missing context\n   - **Technical issues:** Bad shell commands, wrong paths, parsing failures\n   - **False failures:** Exit codes that look like errors but aren't (like the `; true` fix)\n\n4. **If you find issues:**\n   - Use `cron` tool with `action: update`, `jobId`, and a `patch` object to fix the job\n   - Common fixes: add `; true` to shell loops, improve error handling, clarify instructions\n   - Log what you changed to `memory/YYYY-MM-DD.md`\n\n5. **If a job is consistently failing and you can't fix it:**\n   - Disable it with `patch: {\"enabled\": false}`\n   - Note it in the daily memory file for Ali to review\n\n6. **Finish quietly** unless you made changes or found something Ali should know about.\n\nBe conservative ‚Äî only modify jobs when there's a clear problem and clear fix. Don't change jobs that are working fine.",
        "timeoutSeconds": 180
      },
      "state": {
        "nextRunAtMs": 1771160400000
      },
      "delivery": {
        "mode": "announce"
      }
    },
    {
      "id": "2b838c93-d223-46b9-af14-03d92f897f98",
      "agentId": "main",
      "name": "Weekly Memory Summary",
      "enabled": true,
      "createdAtMs": 1771159088107,
      "updatedAtMs": 1771159088107,
      "schedule": {
        "kind": "cron",
        "expr": "30 23 * * 0",
        "tz": "Asia/Tokyo"
      },
      "sessionTarget": "isolated",
      "wakeMode": "next-heartbeat",
      "payload": {
        "kind": "agentTurn",
        "message": "You are running the weekly memory summary job. Create a week-level summary of what happened.\n\n## Steps:\n\n1. **Get the current week number:**\n   ```bash\n   date +%Y-W%V\n   ```\n   This gives you the ISO week (e.g., 2026-W07).\n\n2. **Find this week's daily memory files:**\n   ```bash\n   # Get the dates for this week (Monday to Sunday)\n   for i in {6..0}; do date -v-${i}d +%Y-%m-%d; done\n   ```\n   Then read each `memory/YYYY-MM-DD.md` that exists.\n\n3. **Read the daily files:**\n   Use the `read` tool to read each day's memory file. Note which days had activity vs light/cron-only days.\n\n4. **If needed, check session logs for more context:**\n   Session logs are at `~/.openclaw/agents/main/sessions/*.jsonl`\n   Only dig into these if the daily summaries feel thin or you need more detail.\n\n5. **Create the weekly summary at `memory/YYYY-Www.md`:**\n   Structure:\n   ```markdown\n   # YYYY-Www ‚Äî Week Summary\n   \n   ## Highlights\n   (Major events, accomplishments, decisions)\n   \n   ## Themes\n   (Recurring topics, patterns noticed)\n   \n   ## Work\n   (Arch, Givery, tours, projects)\n   \n   ## Personal\n   (Health, relationships, social)\n   \n   ## Lessons / Reflections\n   (What was learned, what to carry forward)\n   \n   ## Next Week\n   (Upcoming events, intentions, carryover todos)\n   ```\n   Keep it scannable. This is the bird's-eye view.\n\n6. **Consider updates to MEMORY.md:**\n   If something from this week is significant enough for long-term memory, add it.\n\n7. **Git commit** the changes.\n\n8. **Finish quietly** ‚Äî no need to message Ali unless something notable.",
        "timeoutSeconds": 300
      },
      "state": {
        "nextRunAtMs": 1771165800000
      },
      "delivery": {
        "mode": "announce"
      }
    }
  ]
}